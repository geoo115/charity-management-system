name: Security Vulnerability Report
description: Report a security vulnerability
labels: ["security", "vulnerability"]
assignees:
  - geoo115
body:
  - type: markdown
    attributes:
      value: |
        Thanks for reporting a security vulnerability! Please provide the following information to help us understand and fix the issue.

        **⚠️ IMPORTANT: Do not include sensitive information in this public issue. For sensitive vulnerabilities, email security@lewisham-charity.com instead.**

  - type: dropdown
    id: severity
    attributes:
      label: Severity Level
      description: How severe is this vulnerability?
      options:
        - Critical
        - High
        - Medium
        - Low
      default: 0
    validations:
      required: true

  - type: dropdown
    id: component
    attributes:
      label: Affected Component
      description: Which part of the system is affected?
      options:
        - Frontend (Next.js)
        - Backend (Go API)
        - Database
        - Infrastructure/Docker
        - Dependencies
        - Authentication
        - Other
    validations:
      required: true

  - type: textarea
    id: description
    attributes:
      label: Vulnerability Description
      description: Describe the vulnerability in detail
      placeholder: What is the vulnerability and how does it work?
    validations:
      required: true

  - type: textarea
    id: reproduction
    attributes:
      label: Steps to Reproduce
      description: How can we reproduce this vulnerability?
      placeholder: |
        1. Go to '...'
        2. Click on '....'
        3. Submit payload '....'
        4. See error
    validations:
      required: true

  - type: textarea
    id: impact
    attributes:
      label: Potential Impact
      description: What could happen if this vulnerability is exploited?
      placeholder: Data breach, unauthorized access, etc.
    validations:
      required: true

  - type: textarea
    id: mitigation
    attributes:
      label: Suggested Mitigation
      description: Do you have suggestions for fixing this vulnerability?
      placeholder: Input validation, authentication checks, etc.

  - type: dropdown
    id: environment
    attributes:
      label: Environment
      description: Where did you find this vulnerability?
      options:
        - Production
        - Staging
        - Development
        - Local
      default: 3
    validations:
      required: true

  - type: checkboxes
    id: checklist
    attributes:
      label: Security Checklist
      description: Please confirm you have
      options:
        - label: I have not shared this vulnerability publicly
          required: true
        - label: I have checked this is not a duplicate issue
          required: true
        - label: I understand this will be handled responsibly
          required: true